!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@onflow/fcl-config"),require("@onflow/config"),require("fs"),require("path"),require("@onflow/fcl"),require("elliptic"),require("sha3"),require("rlp"),require("@onflow/types"),require("flow-cadut")):"function"==typeof define&&define.amd?define(["exports","@onflow/fcl-config","@onflow/config","fs","path","@onflow/fcl","elliptic","sha3","rlp","@onflow/types","flow-cadut"],r):r((e||self).flowJsTesting={},e.fclConfig,e.config,e.fs,e.path,e.fcl,e.elliptic,e.sha3,e.rlp,e.t,e.flowCadut)}(this,function(e,r,n,t,o,a,c,s,i,u,l){function d(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function f(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach(function(n){if("default"!==n){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})}}),r.default=e,r}var g=d(t),m=d(o),p=f(a),h=f(i),v=f(u),P=function e(r,n,t){if("string"==typeof n)return e(r,n.split("/"),t);if(!n.length)return r;try{var o=n[0],a=n.slice(1);return e(r[o],a,t)}catch(e){return t}},M=function(e,t,o,a){n.config().put(e,t||P(r.flowConfig(),o,a))};function A(){return(A=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e}).apply(this,arguments)}var y=/(\s*import\s*)([\w\d]+)(\s+from\s*)([\w\d".\\/]+)/g,b=function(e){return e.split(/\s/).map(function(e){return e.replace(/\s/g,"")}).filter(function(e){return e.length>0&&"import"!==e&&"from"!==e})},w=function(e,r){return e[r[0]]=r[1],e},S=function(e,r,n){return void 0===n&&(n=!0),e.replace(y,function(e,t,o,a,c){var s=n?o:c;return""+t+o+" from "+(r instanceof Function?r(s):r[s])})},T={FlowToken:"0x0ae53cb6e3f42a79",FungibleToken:"0xee82856bf20e2aa6",FlowFees:"0xe5a8b7f23e8b548f",FlowStorageFees:"0xf8d6e0586b0a20c7"},x={"0xe5a8b7f23e8b548f":"0xe5a8b7f23e8b548f","0xf8d6e0586b0a20c7":"0xf8d6e0586b0a20c7","0x0ae53cb6e3f42a79":"0x0ae53cb6e3f42a79","0xee82856bf20e2aa6":"0xee82856bf20e2aa6"},j=function(e,r){void 0===r&&(r="./transactions/");try{return Promise.resolve(n.config().get("BASE_PATH")).then(function(n){return m.default.resolve(n,r+"/"+e+".cdc")})}catch(e){return Promise.reject(e)}},k=function(e,r,n){void 0===r&&(r={}),void 0===n&&(n=!1);var t=function(e){return g.default.readFileSync(e,"utf8")}(e);return r?S(t,A({},n?x:T,r)):t},E=function(e){var r=e.name,n=e.addressMap;try{return Promise.resolve(j(r,"./contracts/")).then(function(e){return k(e,n)})}catch(e){return Promise.reject(e)}},F=function(e){var r=e.name,n=e.addressMap;try{return Promise.resolve(j(r,"./transactions/")).then(function(e){return k(e,n)})}catch(e){return Promise.reject(e)}},I=function(e){var r=e.name,n=e.addressMap;try{return Promise.resolve(j(r,"./scripts/")).then(function(e){return k(e,n)})}catch(e){return Promise.reject(e)}},C=function(e){return null==e?null:e.replace(/^0x/,"")},R=function(e){return null==e?null:"0x"+C(e)},B=new c.ec("p256"),D=function(e,r){return void 0===r&&(r=0),function(t){void 0===t&&(t={});try{return Promise.resolve(n.config().get("SERVICE_ADDRESS")).then(function(o){return Promise.resolve(n.config().get("PRIVATE_KEY")).then(function(n){return e=C(e||o),A({},t,{tempId:e+"-"+r,addr:p.sansPrefix(e),keyId:r,signingFunction:function(t){try{return Promise.resolve({keyId:r,addr:R(e),signature:(o=n,a=t.message,c=B.keyFromPrivate(Buffer.from(o,"hex")).sign(function(e){var r=new s.SHA3(256);return r.update(Buffer.from(e,"hex")),r.digest()}(a)),i=c.r.toArrayLike(Buffer,"be",32),u=c.s.toArrayLike(Buffer,"be",32),Buffer.concat([i,u]).toString("hex"))})}catch(e){return Promise.reject(e)}var o,a,c,i,u}})})})}catch(e){return Promise.reject(e)}}},_=function(e,r){var n=e[e.length-1];return e.slice(0,-1).map(function(e){return r(e,n)})},O=function(e){return e.reduce(function(e,r){var n=_(r,function(e,r){return p.arg(e,r)});return[].concat(e,n)},[])},H=function(e){return function(r){try{var n,t,o,a,c,s=function(){return{code:n,signers:o,args:a}};if("object"==typeof(p=r[0])&&null!==p){var i=r[0],u=i.name,l=i.addressMap,d=i.code,f=i.args,g=i.signers;if(!u&&!d)throw Error("Both `name` and `code` are missing. Provide either of them");t=u,c=l||{},n=d,o=g,a=f}else t=r[0],o=r[2],c=r[1]||{};var m=function(){if(t)return Promise.resolve(("script"===e?I:F)({name:t,addressMap:c})).then(function(e){n=e})}();return Promise.resolve(m&&m.then?m.then(s):s())}catch(e){return Promise.reject(e)}var p}},q=function(){try{var e=arguments,r=H("tx");return Promise.resolve(r([].slice.call(e))).then(function(e){var r=e.code,n=e.args,t=e.signers,o=D(),a=[p.transaction(r),p.payer(o),p.proposer(o),p.limit(999)];if(t){var c=t.map(function(e){return D(e)});a.push(p.authorizations(c))}else a.push(p.authorizations([o]));return n&&a.push(p.args(O(n))),Promise.resolve(p.send(a)).then(function(e){return Promise.resolve(p.tx(e).onceExecuted())})})}catch(e){return Promise.reject(e)}},L=function(){try{var e=arguments,r=H("script");return Promise.resolve(r([].slice.call(e))).then(function(e){var r=e.args,n=[p.script(e.code)];return r&&n.push(p.args(O(r))),Promise.resolve(p.send(n)).then(function(e){return p.decode(e)})})}catch(e){return Promise.reject(e)}},V="\n  pub contract FlowManager {\n\n    pub event AccountAdded(address: Address)\n\n    pub struct Mapper {\n        pub let accounts: {String: Address}\n\n        pub fun getAddress(_ name: String): Address? {\n            return self.accounts[name]\n        }\n\n        pub fun setAddress(_ name: String, address: Address){\n            self.accounts[name] = address\n            emit FlowManager.AccountAdded(address: address)\n        }\n\n        init(){\n            self.accounts = {}\n        }\n    }\n\n    pub let accountManagerStorage: StoragePath\n    pub let contractManagerStorage: StoragePath\n    pub let accountManagerPath: PublicPath\n    pub let contractManagerPath: PublicPath\n\n    init(){\n        let accountManager = Mapper()\n        let contractManager = Mapper()\n\n        self.accountManagerStorage = /storage/testSuitAccountManager\n        self.contractManagerStorage = /storage/testSuitContractManager\n\n        self.accountManagerPath = /public/testSuitAccountManager\n        self.contractManagerPath = /public/testSuitContractManager\n        \n        // Destroy previously stored values\n        self.account.load<Mapper>(from: self.accountManagerStorage)\n        self.account.load<Mapper>(from: self.contractManagerStorage)\n\n        self.account.save(accountManager, to: self.accountManagerStorage)\n        self.account.save(contractManager, to: self.contractManagerStorage)\n\n        self.account.link<&Mapper>(self.accountManagerPath, target: self.accountManagerStorage)\n        self.account.link<&Mapper>(self.contractManagerPath, target: self.contractManagerStorage)\n    }\n}\n \n",K="\n  import FlowManager from 0x01\n\npub fun main(){\n    // the body can be empty. The script will throw error if FlowManager is not\n    // added to service address\n}\n\n",G="\n  import FlowManager from 0x01\n\npub fun main(name: String, managerAccount: Address):Address? {\n    let manager = getAccount(managerAccount)\n    let linkPath = FlowManager.accountManagerPath\n    let accountManager = manager\n                        .getCapability(linkPath)\n                        .borrow<&FlowManager.Mapper>()!\n\n    return accountManager.getAddress(name)\n\n}\n",N='\n  // This script reads the balance field of an account\'s FlowToken Balance\n\nimport FungibleToken from 0xFUNGIBLETOKENADDRESS\nimport ExampleToken from 0xTOKENADDRESS\n\npub fun main(account: Address): UFix64 {\n    let acct = getAccount(account)\n    let vaultRef = acct.getCapability(/public/exampleTokenBalance)!.borrow<&ExampleToken.Vault{FungibleToken.Balance}>()\n        ?? panic("Could not borrow Balance reference to the Vault")\n\n    return vaultRef.balance\n}\n',z="\n  import FlowManager from 0x01\n\npub fun main(name: String, managerAccount: Address):Address? {\n    let manager = getAccount(managerAccount)\n    let linkPath = FlowManager.contractManagerPath\n    let contractManager = manager\n                        .getCapability(linkPath)\n                        .borrow<&FlowManager.Mapper>()!\n\n    return contractManager.getAddress(name)\n\n}\n",U="\n  import FlowManager from 0x01\n\ntransaction (_ name: String, pubKey: String, manager: Address) {\n    prepare( admin: AuthAccount) {\n        let newAccount = AuthAccount(payer:admin)\n        newAccount.addPublicKey(pubKey.decodeHex())\n\n        let linkPath = FlowManager.accountManagerPath\n        let accountManager = getAccount(manager)\n                            .getCapability(linkPath)!\n                            .borrow<&FlowManager.Mapper>()!\n        \n        // Create a record in account database\n        let address = newAccount.address\n        accountManager.setAddress(name, address: address)\n    }\n}\n \n",Y=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(U,n,"createAccount =>"),l.replaceImportAddresses(U,n)})}catch(e){return Promise.reject(e)}},W="\n  import FlowManager from 0x01\n\ntransaction(name:String, code: String, manager: Address ##ARGS-WITH-TYPES##) {\n    prepare(acct: AuthAccount){\n        let decoded = code.decodeHex()\n        acct.contracts.add(\n           name: name,\n           code: decoded,\n           ##ARGS-LIST##\n        )\n\n        let linkPath = FlowManager.contractManagerPath\n        let contractManager = getAccount(manager)\n                    .getCapability(linkPath)!\n                    .borrow<&FlowManager.Mapper>()!\n\n        let address = acct.address\n        contractManager.setAddress(name, address: address)\n    }\n}\n",J=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(W,n,"deployContract =>"),l.replaceImportAddresses(W,n)})}catch(e){return Promise.reject(e)}},Q='\n  transaction ( code: String ) {\n    prepare( admin: AuthAccount) {\n        admin.contracts.add(\n           name: "FlowManager",\n           code: code.decodeHex(),\n        )\n   }\n}\n\n',X=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(Q,n,"initManager =>"),l.replaceImportAddresses(Q,n)})}catch(e){return Promise.reject(e)}},Z='\n  import FungibleToken from 0xFUNGIBLETOKENADDRESS\nimport ExampleToken from 0xTOKENADDRESS\n\ntransaction(recipient: Address, amount: UFix64) {\n    let tokenAdmin: &ExampleToken.Administrator\n    let tokenReceiver: &{FungibleToken.Receiver}\n\n    prepare(signer: AuthAccount) {\n        self.tokenAdmin = signer\n        .borrow<&ExampleToken.Administrator>(from: /storage/exampleTokenAdmin)\n        ?? panic("Signer is not the token admin")\n\n        self.tokenReceiver = getAccount(recipient)\n        .getCapability(/public/exampleTokenReceiver)!\n        .borrow<&{FungibleToken.Receiver}>()\n        ?? panic("Unable to borrow receiver reference")\n    }\n\n    execute {\n        let minter <- self.tokenAdmin.createNewMinter(allowedAmount: amount)\n        let mintedVault <- minter.mintTokens(amount: amount)\n\n        self.tokenReceiver.deposit(from: <-mintedVault)\n\n        destroy minter\n    }\n}\n\n',$=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(Z,n,"mintTokens =>"),l.replaceImportAddresses(Z,n)})}catch(e){return Promise.reject(e)}},ee="\n  import FlowManager from 0x01\n\ntransaction(name: String, address: Address) {\n    prepare(signer: AuthAccount){\n        let linkPath = FlowManager.contractManagerPath\n        let contractManager = signer\n                                .getCapability(linkPath)!\n                                .borrow<&FlowManager.Mapper>()!\n        contractManager.setAddress(name, address: address)\n    }\n}\n",re=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(ee,n,"registerContract =>"),l.replaceImportAddresses(ee,n)})}catch(e){return Promise.reject(e)}},ne="\n  transaction{\n    prepare(acct: AuthAccount){\n        log(acct.address)\n    }\n}\n",te=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(ne,n,"scratch =>"),l.replaceImportAddresses(ne,n)})}catch(e){return Promise.reject(e)}},oe="\n  import FlowManager from 0x01\n\ntransaction(name:String, code: String, manager: Address ##ARGS-WITH-TYPES##) {\n    prepare(acct: AuthAccount){\n        let decoded = code.decodeHex()\n\n        if acct.contracts.get(name: name) == nil {\n          acct.contracts.add(name: name, code: decoded)\n        } else {\n          acct.contracts.update__experimental(name: name, code: decoded)\n        }\n\n        let linkPath = FlowManager.contractManagerPath\n        let contractManager = getAccount(manager)\n                    .getCapability(linkPath)!\n                    .borrow<&FlowManager.Mapper>()!\n\n        let address = acct.address\n        contractManager.setAddress(name, address: address)\n    }\n}\n\n",ae=function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(oe,n,"updateContract =>"),l.replaceImportAddresses(oe,n)})}catch(e){return Promise.reject(e)}},ce={createAccount:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve(Y(t)).then(function(r){return l.reportMissing("arguments",a.length,3,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},createAccountTemplate:Y,deployContract:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve(J(t)).then(function(r){return l.reportMissing("arguments",a.length,3,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},deployContractTemplate:J,initManager:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve(X(t)).then(function(r){return l.reportMissing("arguments",a.length,1,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},initManagerTemplate:X,mintTokens:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve($(t)).then(function(r){return l.reportMissing("arguments",a.length,2,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},mintTokensTemplate:$,registerContract:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve(re(t)).then(function(r){return l.reportMissing("arguments",a.length,2,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},registerContractTemplate:re,scratch:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve(te(t)).then(function(r){return l.reportMissing("arguments",a.length,0,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},scratchTemplate:te,updateContract:function e(r){var n=r.addressMap,t=void 0===n?{}:n,o=r.args,a=void 0===o?[]:o,c=r.signers,s=void 0===c?[]:c;try{return Promise.resolve(ae(t)).then(function(r){return l.reportMissing("arguments",a.length,3,e),l.reportMissing("signers",s.length,1,e),q({code:r,args:a,signers:s})})}catch(e){return Promise.reject(e)}},updateContractTemplate:ae},se=ce,ie={ExampleToken:T.FlowToken},ue=function(e){return e[0].toLowerCase()+e.slice(1)},le=function(){try{return Promise.resolve(n.config().get("SERVICE_ADDRESS")).then(R)}catch(e){return Promise.reject(e)}},de=function(){try{return Promise.resolve(le()).then(function(e){return Promise.resolve(function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(K,n,"checkManager =>"),l.replaceImportAddresses(K,n)})}catch(e){return Promise.reject(e)}}({FlowManager:e})).then(function(e){var r=function(r,n){try{var t=Promise.resolve(L({code:e})).then(function(){})}catch(e){return n()}return t&&t.then?t.then(void 0,n):t}(0,function(){return Promise.resolve(function(){try{return Promise.resolve(se.initManagerTemplate()).then(function(e){return Promise.resolve(function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(V,n,"FlowManager =>"),l.replaceImportAddresses(V,n)})}catch(e){return Promise.reject(e)}}()).then(function(r){var n=he(r);return Promise.resolve(q({code:e,args:[[n,v.String]]})).then(function(){})})})}catch(e){return Promise.reject(e)}}()).then(function(){})});return r&&r.then?r.then(function(){return le()}):le()})})}catch(e){return Promise.reject(e)}};function fe(e,r){try{var n=e()}catch(e){return r(e)}return n&&n.then?n.then(void 0,r):n}var ge=function(e){try{var r=e||"deployment-account-"+(Math.random()*Math.pow(10,8)).toFixed(0);return Promise.resolve(de()).then(function(e){function t(){var t=function(){if(null===o){var t=fe(function(){return Promise.resolve(se.createAccountTemplate(a)).then(function(t){return Promise.resolve(function(){try{var e=B.keyFromPrivate,r=Buffer,t=r.from;return Promise.resolve(n.config().get("PRIVATE_KEY")).then(function(n){var o=e.call(B,t.call(r,n,"hex")).getPublic("hex").replace(/^04/,"");return h.encode([Buffer.from(o,"hex"),2,3,1e3]).toString("hex")})}catch(e){return Promise.reject(e)}}()).then(function(n){return Promise.resolve(q({code:t,args:[[r,n,v.String],[e,v.Address]]})).then(function(e){var r=e.events.find(function(e){return e.type.includes("AccountAdded")});o=r.data.address})})})},function(e){console.error(e)});if(t&&t.then)return t.then(function(){})}}();return t&&t.then?t.then(function(){return o}):o}var o,a={FlowManager:e},c=fe(function(){return Promise.resolve(function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(G,n,"getAccountAddress =>"),l.replaceImportAddresses(G,n)})}catch(e){return Promise.reject(e)}}(a)).then(function(n){return Promise.resolve(L({code:n,args:[[r,v.String],[e,v.Address]]})).then(function(e){o=e})})},function(e){console.error("failed to get account address:",e)});return c&&c.then?c.then(t):t()})}catch(e){return Promise.reject(e)}},me=ce.updateContractTemplate,pe=ce.deployContractTemplate,he=function(e){return Buffer.from(e,"utf8").toString("hex")},ve=function(e){try{var r=function(e){return Promise.resolve(le()).then(function(r){var n=he(t),s={FlowManager:r};return Promise.resolve(c?me(s):pe(s)).then(function(t){var c=[[o,n,v.String],[r,v.Address]];if(a){c=c.concat(a);var s=0,i=[],u=a.reduce(function(e,r){var n=_(r,function(e,r){var n="abcdefghijklmnopqrstuvwxyz"[s];return s+=1,i.push(n),n+":"+r.label});return[].concat(e,n)},[]);t=(t=t.replace("##ARGS-WITH-TYPES##",", "+u)).replace("##ARGS-LIST##",i)}else t=(t=t.replace("##ARGS-WITH-TYPES##","")).replace("##ARGS-LIST##","");return q({code:t,args:c,signers:[e]})})})},n=e.to,t=e.code,o=e.name,a=e.args,c=e.update;return Promise.resolve(n?r(n):Promise.resolve(ge()).then(r))}catch(e){return Promise.reject(e)}},Pe=global.expect,Me=function(e){try{var r,n=function(n){return r?n:Promise.resolve(e)},t=function(){if("function"==typeof e)return r=1,Promise.resolve(e())}();return Promise.resolve(t&&t.then?t.then(n):n(t))}catch(e){return Promise.reject(e)}},Ae=require("child_process").spawn,ye=new(function(){function e(){this.initialized=!1,this.logging=!0}var r=e.prototype;return r.setLogging=function(e){this.logging=e},r.log=function(e,r){void 0===r&&(r="log"),this.logging&&console[r](e)},r.start=function(e,r){void 0===e&&(e=8080),void 0===r&&(r=!1);try{var n=this,t=e-8080+3569;return n.logging=r,n.process=Ae("flow",["emulator","-v","--http-port",e,"--port",t]),Promise.resolve(new Promise(function(e,r){n.process.stdout.on("data",function(r){n.log("LOG: "+r),r.includes("Starting HTTP server")&&(n.log("EMULATOR IS UP! Listening for events!"),n.initialized=!0,e(!0))}),n.process.stderr.on("data",function(e){n.log("stderr: "+e,"error"),n.initialized=!1,r()}),n.process.on("close",function(r){n.log("emulator exited with code "+r),n.initialized=!1,e(!0)})}))}catch(e){return Promise.reject(e)}},r.stop=function(){try{var e=this;return Promise.resolve(new Promise(function(r){e.process.kill(),setTimeout(function(){e.initialized=!1,r(!0)},0)}))}catch(e){return Promise.reject(e)}},e}());e.deployContract=ve,e.deployContractByName=function(e){try{var r=function(e){return Promise.resolve(E({name:t,addressMap:o})).then(function(r){return ve({to:e,code:r,name:t,args:a,update:s})})},n=e.to,t=e.name,o=e.addressMap,a=e.args,c=e.update,s=void 0!==c&&c;return Promise.resolve(n?r(n):Promise.resolve(ge()).then(r))}catch(e){return Promise.reject(e)}},e.emulator=ye,e.executeScript=L,e.extractImports=function(e){return e&&0!==e.length?e.split("\n").filter(function(e){return e.includes("import")}).map(b).reduce(w,{}):{}},e.getAccountAddress=ge,e.getConfigValue=function(e){try{return Promise.resolve(n.config().get(e))}catch(e){return Promise.reject(e)}},e.getContractAddress=function(e,r){void 0===r&&(r=!1);try{if(r){var n=T[e];if(void 0!==n)return Promise.resolve(n)}return Promise.resolve(de()).then(function(r){var n,t={FlowManager:r},o=function(o,a){try{var c=Promise.resolve(function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(z,n,"getContractAddress =>"),l.replaceImportAddresses(z,n)})}catch(e){return Promise.reject(e)}}(t)).then(function(t){return Promise.resolve(L({code:t,args:[[e,v.String],[r,v.Address]]})).then(function(e){n=e})})}catch(e){return a(e)}return c&&c.then?c.then(void 0,a):c}(0,function(e){console.error("failed to get account address:",e)});return o&&o.then?o.then(function(){return n}):n})}catch(e){return Promise.reject(e)}},e.getContractCode=E,e.getFlowBalance=function(e){try{return Promise.resolve(function(e){try{return Promise.resolve(function(e){void 0===e&&(e={});try{return Promise.resolve(l.getEnvironment()).then(function(r){var n=A({},r,e);return l.reportMissingImports(N,n,"getBalance =>"),l.replaceImportAddresses(N,n)})}catch(e){return Promise.reject(e)}}(ie)).then(function(r){return r.replace(/(ExampleToken)/gi,function(r){return"ExampleToken"===r?e:ue(e)})})}catch(e){return Promise.reject(e)}}("FlowToken")).then(function(r){var n=S(r,T);return L({code:n,args:[[e,v.Address]]})})}catch(e){return Promise.reject(e)}},e.getScriptCode=I,e.getTemplate=k,e.getTransactionCode=F,e.init=function(e,r){void 0===r&&(r=8080);try{return M("PRIVATE_KEY",process.env.PK,"accounts/emulator-account/keys"),M("SERVICE_ADDRESS",process.env.SERVICE_ADDRESS,"accounts/emulator-account/address","f8d6e0586b0a20c7"),n.config().put("accessNode.api","http://localhost:"+r),M("BASE_PATH",process.env.BASE_PATH,"resolve/basePath",e),Promise.resolve()}catch(e){return Promise.reject(e)}},e.mintFlow=function(e,r){try{return Promise.resolve(function(e){try{return Promise.resolve(se.mintTokensTemplate(ie)).then(function(r){return r.replace(/(ExampleToken)/gi,function(r){return"ExampleToken"===r?e:ue(e)})})}catch(e){return Promise.reject(e)}}("FlowToken")).then(function(n){var t=S(n,T);return q({code:t,args:[[e,v.Address],[r,v.UFix64]]})})}catch(e){return Promise.reject(e)}},e.promise=Me,e.replaceImportAddresses=S,e.sendTransaction=q,e.set=M,e.shallPass=function(e){try{var r=Me(e);return Promise.resolve(Pe(r).resolves.not.toBe(null)).then(function(){return Promise.resolve(Pe(r).resolves.not.toThrow()).then(function(){return r.then(function(e){var r=e.errorMessage;Pe(e.status).toBe(4),Pe(r).toBe("")}),r})})}catch(e){return Promise.reject(e)}},e.shallResolve=function(e){try{var r=Me(e);return Promise.resolve(Pe(r).resolves.not.toThrow()).then(function(){return r})}catch(e){return Promise.reject(e)}},e.shallRevert=function(e){try{var r=Me(e);return Promise.resolve(Pe(r).rejects.not.toBe(null)).then(function(){})}catch(e){return Promise.reject(e)}},e.shallThrow=function(e){try{var r=Me(e);return Promise.resolve(Pe(r).rejects.not.toBe(null)).then(function(){return Promise.resolve(Pe(r).rejects.toThrow()).then(function(){})})}catch(e){return Promise.reject(e)}}});
//# sourceMappingURL=index.umd.js.map
