!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@onflow/config"),require("@onflow/util-invariant"),require("@onflow/protobuf"),require("@onflow/util-address"),require("@improbable-eng/grpc-web"),require("@improbable-eng/grpc-web-node-http-transport"),require("@onflow/rlp"),require("@onflow/util-template")):"function"==typeof define&&define.amd?define(["exports","@onflow/config","@onflow/util-invariant","@onflow/protobuf","@onflow/util-address","@improbable-eng/grpc-web","@improbable-eng/grpc-web-node-http-transport","@onflow/rlp","@onflow/util-template"],n):n((e=e||self).sdk={},e.config,e.utilInvariant,e.protobuf,e.utilAddress,e.grpcWeb,e.grpcWebNodeHttpTransport,e.rlp,e.utilTemplate)}(this,function(e,n,t,r,o,a,i,s,u){function c(){return(c=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)}function l(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}var f='{\n  "tag":"UNKNOWN",\n  "assigns":{},\n  "status":"OK",\n  "reason":null,\n  "accounts":{},\n  "params":{},\n  "arguments":{},\n  "message": {\n    "cadence":null,\n    "refBlock":null,\n    "computLimit":null,\n    "proposer":null,\n    "payer":null,\n    "authorizations":[],\n    "params":[],\n    "arguments":[]\n  },\n  "proposer":null,\n  "authorizations":[],\n  "payer":null,\n  "events": {\n    "eventType":null,\n    "start":null,\n    "end":null,\n    "blockIds":[]\n  },\n  "transaction": {\n    "id":null\n  },\n  "block": {\n    "id":null,\n    "height":null,\n    "isSealed":null\n  },\n  "account": {\n    "addr":null\n  }\n}',d=new Set(Object.keys(JSON.parse(f))),m=function(){return JSON.parse(f)},g=function(e){return Array.isArray(e)},p=function(e){return null==e},h="abcdefghijklmnopqrstuvwxyz0123456789".split(""),v=function(){return h[~~(Math.random()*h.length)]},y=function(){return Array.from({length:10},v).join("")},k=function(e){return e.status="OK",e},b=function(e,n){return e.status="BAD",e.reason=n,e},I=function(e){return function(n){return n.tag=e,k(n)}},P=function(e,n){return function(t){return t.accounts[n]=JSON.parse('{\n  "kind":"ACCOUNT",\n  "tempId":null,\n  "addr":null,\n  "keyId":null,\n  "sequenceNum":null,\n  "signature":null,\n  "signingFunction":null,\n  "resolve":null,\n  "role": {\n    "proposer":false,\n    "authorizer":false,\n    "payer":false,\n    "param":false\n  }\n}'),t.accounts[n].tempId=n,t.accounts[n].addr=e.addr,t.accounts[n].keyId=e.keyId,t.accounts[n].sequenceNum=e.sequenceNum,t.accounts[n].signature=e.signature,t.accounts[n].signingFunction=e.signingFunction,t.accounts[n].resolve=e.resolve,t.accounts[n].role=c({},t.accounts[n].role,e.role),k(t)}},S=function(e){return function(n){var t=y();return n.message.params.push(t),n.params[t]=JSON.parse('{\n  "kind":"PARAM",\n  "tempId":null,\n  "key":null,\n  "value":null,\n  "asParam":null,\n  "xform":null,\n  "resolve": null\n}'),n.params[t].tempId=t,n.params[t].key=e.key,n.params[t].value=e.value,n.params[t].asParam=e.asParam,n.params[t].xform=e.xform,n.params[t].resolve=e.resolve,k(n)}},w=function(e){return function(n){var t=y();return n.message.arguments.push(t),n.arguments[t]=JSON.parse('{\n  "kind":"ARGUMENT",\n  "tempId":null,\n  "value":null,\n  "asArgument":null,\n  "xform":null,\n  "resolve": null\n}'),n.arguments[t].tempId=t,n.arguments[t].value=e.value,n.arguments[t].asArgument=e.asArgument,n.arguments[t].xform=e.xform,n.arguments[t].resolve=e.resolve,k(n)}},A=I("SCRIPT"),B=I("TRANSACTION"),T=I("GET_TRANSACTION_STATUS"),x=I("GET_TRANSACTION"),N=I("GET_ACCOUNT"),E=I("GET_EVENTS"),j=I("GET_LATEST_BLOCK"),O=I("GET_BLOCK_BY_ID"),L=I("GET_BLOCK_BY_HEIGHT"),_=I("PING"),R=I("GET_BLOCK"),G=I("GET_BLOCK_HEADER"),U=function(e){return function(n){return n.tag===e}},C=U("UNKNOWN"),D=U("SCRIPT"),K=U("TRANSACTION"),q=U("GET_TRANSACTION_STATUS"),H=U("GET_TRANSACTION"),z=U("GET_ACCOUNT"),F=U("GET_EVENTS"),J=U("GET_LATEST_BLOCK"),W=U("GET_BLOCK_BY_ID"),M=U("GET_BLOCK_BY_HEIGHT"),Y=U("PING"),V=U("GET_BLOCK"),$=U("GET_BLOCK_HEADER"),X=function(e){return"BAD"===e.status},Q=function e(n,t){void 0===t&&(t=[]);try{return Promise.resolve(function(r,o){try{var a=Promise.resolve(n).then(function(r){if(n=function(e){for(var n=0,t=Object.keys(e);n<t.length;n++){var r=t[n];if(!d.has(r))throw new Error('"'+r+'" is an invalid root level Interaction property.')}return e}(r),X(n))throw new Error("Interaction Error: "+n.reason);if(!t.length)return n;var o=t[0],a=t.slice(1);return Promise.resolve(o).then(function(t){if("function"==typeof t)return e(t(n),a);if(p(t)||!t)return e(n,a);if(function(e){if("object"!=typeof e||p(e)||"number"===e)return!1;for(var n,t=function(e,n){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,n){if(e){if("string"==typeof e)return l(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(e,void 0):void 0}}(e))){t&&(e=t);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}(d);!(n=t()).done;)if(!e.hasOwnProperty(n.value))return!1;return!0}(t))return e(t,a);throw new Error("Invalid Interaction Composition")})})}catch(e){return o(e)}return a&&a.then?a.then(void 0,o):a}(0,function(e){throw e}))}catch(e){return Promise.reject(e)}},Z=function e(){var n=[].slice.call(arguments),t=n[0],r=n[1];return g(t)&&null==r?function(n){return e(n,t)}:Q(t,r)},ee=function(e){return e},ne=function(e,n,t){return null==e.assigns[n]?t:e.assigns[n]},te=function(e,n){return function(t){return t.assigns[e]=n,k(t)}},re=function(e,n){return void 0===n&&(n=ee),function(t){return t.assigns[e]=n(t.assigns[e],t),k(t)}};function oe(e){return void 0===e&&(e=[]),Z(m(),e)}var ae=function(){return JSON.parse('{"tag": 0, "transaction":null, "transactionId":null, "encodedData":null, "events": null, "account": null}')},ie=function(e,n,t){try{return Promise.resolve(new Promise(function(r,o){a.grpc.unary(n,{request:t,host:e,onEnd:function(e){var n=e.statusMessage;e.status===a.grpc.Code.OK?r(e.message):o(new Error(n))}})}))}catch(e){return Promise.reject(e)}};a.grpc.setDefaultTransport(i.NodeHttpTransport());var se=function(e){return Buffer.from(e,"hex")},ue=function(e){return Buffer.from(e.padStart(16,0),"hex")},ce=function(e){return Buffer.from(e).toString("hex")},le=function(e){return Buffer.from(e).toString("hex")},fe=function(e){return Buffer.from(e).toString("hex")},de=function(e){return Buffer.from(e).toString("hex")},me=function(e){return Buffer.from(e).toString("hex")},ge=function(e,t){void 0===t&&(t={});try{var a=function(n){return t.node=n,Promise.resolve(e).then(function(n){switch(e=n,!0){case K(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var a=new r.Transaction;a.setScript(Buffer.from(e.message.cadence,"utf8")),a.setGasLimit(e.message.computeLimit),a.setReferenceBlockId(e.message.refBlock?se(e.message.refBlock):null),a.setPayer(ue(o.sansPrefix(e.accounts[e.payer].addr))),e.message.arguments.forEach(function(n){return a.addArguments(function(e){return Buffer.from(JSON.stringify(e),"utf8")}(e.arguments[n].asArgument))}),e.authorizations.map(function(n){return e.accounts[n].addr}).reduce(function(e,n){return e.find(function(e){return e===n})?e:[].concat(e,[n])},[]).forEach(function(e){return a.addAuthorizers(ue(o.sansPrefix(e)))});var i=new r.Transaction.ProposalKey;i.setAddress(ue(o.sansPrefix(e.accounts[e.proposer].addr))),i.setKeyId(e.accounts[e.proposer].keyId),i.setSequenceNumber(e.accounts[e.proposer].sequenceNum),a.setProposalKey(i);for(var s=0,u=Object.values(e.accounts);s<u.length;s++){var c=u[s];try{if(!c.role.payer&&null!=c.signature){var l=new r.Transaction.Signature;l.setAddress(ue(o.sansPrefix(c.addr))),l.setKeyId(c.keyId),l.setSignature(se(c.signature)),a.addPayloadSignatures(l)}}catch(n){throw console.error("Trouble applying payload signature",{acct:c,ix:e}),n}}for(var f=0,d=Object.values(e.accounts);f<d.length;f++){var m=d[f];try{if(m.role.payer&&null!=m.signature){var g=new r.Transaction.Signature;g.setAddress(ue(o.sansPrefix(m.addr))),g.setKeyId(m.keyId),g.setSignature(se(m.signature)),a.addEnvelopeSignatures(g)}}catch(n){throw console.error("Trouble applying envelope signature",{acct:m,ix:e}),n}}var p=new r.SendTransactionRequest;p.setTransaction(a);var h=Date.now();return Promise.resolve(ie(n.node,r.AccessAPI.SendTransaction,p)).then(function(n){var t,r=Date.now(),o=ae();return o.tag=e.tag,o.transactionId=(t=n.getId_asU8(),Buffer.from(t).toString("hex")),"undefined"!=typeof window&&window.dispatchEvent(new CustomEvent("FLOW::TX",{detail:{txId:o.transactionId,delta:r-h}})),o})})}catch(e){return Promise.reject(e)}}(e,t);case q(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var o=new r.GetTransactionRequest;return o.setId(Buffer.from(e.transaction.id,"hex")),Promise.resolve(ie(n.node,r.AccessAPI.GetTransactionResult,o)).then(function(n){var t=n.getEventsList(),r=ae();return r.tag=e.tag,r.transaction={status:n.getStatus(),statusCode:n.getStatusCode(),errorMessage:n.getErrorMessage(),events:t.map(function(e){return{type:e.getType(),transactionId:(n=e.getTransactionId_asU8(),Buffer.from(n).toString("hex")),transactionIndex:e.getTransactionIndex(),eventIndex:e.getEventIndex(),payload:JSON.parse(Buffer.from(e.getPayload_asU8()).toString("utf8"))};var n})},r})})}catch(e){return Promise.reject(e)}}(e,t);case H(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var o=new r.GetTransactionRequest;return o.setId(Buffer.from(e.transaction.id,"hex")),Promise.resolve(ie(n.node,r.AccessAPI.GetTransaction,o)).then(function(n){n.getEventsList();var t=ae();t.tag=e.tag;var r=function(e){return{address:ce(key.getAddress_asU8()),keyId:key.getKeyId(),signature:ce(key.getSequenceNumber_asU8())}},o=t.getTransaction();return t.transaction={script:ce(o.getScript_asU8()),_arguments2:o.getArgumentsList().map(ce),referenceBlockId:ce(o.getReferenceBlockId_asU8()),gasLimit:o.getGasLimit(),proposalKey:function(e){return{address:ce(e.getAddress_asU8()),keyId:e.getKeyId(),sequenceNumber:e.getSequenceNumber()}}(o.getProposalKey()),payer:ce(o.getPayer_asU8()),authorizers:o.getAuthorizersList().map(ce),payloadSignatures:o.getPayloadSignaturesList().map(r),envelopeSignatures:o.getEnvelopeSignaturesList().map(r)},t})})}catch(e){return Promise.reject(e)}}(e,t);case D(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){var o;(e=t).block.id?(o=new r.ExecuteScriptAtBlockIDRequest).setBlockId(Buffer.from(e.block.id,"hex")):e.block.height?(o=new r.ExecuteScriptAtBlockHeightRequest).setBlockHeight(Number(e.block.height)):o=new r.ExecuteScriptAtLatestBlockRequest;var a=Buffer.from(e.message.cadence,"utf8");return e.message.arguments.forEach(function(n){return o.addArguments(function(e){return Buffer.from(JSON.stringify(e),"utf8")}(e.arguments[n].asArgument))}),o.setScript(a),Promise.resolve(ie(n.node,r.AccessAPI.ExecuteScriptAtLatestBlock,o)).then(function(n){var t=ae();return t.tag=e.tag,t.encodedData=JSON.parse(Buffer.from(n.getValue_asU8()).toString("utf8")),t})})}catch(e){return Promise.reject(e)}}(e,t);case z(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){var a,i=(e=t).block.height?new r.GetAccountAtBlockHeightRequest:new r.GetAccountAtLatestBlockRequest;return e.block.height&&i.setHeight(Number(e.block.height)),i.setAddress((a=o.sansPrefix(e.account.addr),Buffer.from(a.padStart(16,0),"hex"))),Promise.resolve(ie(n.node,r.AccessAPI.GetAccount,i)).then(function(n){var t=ae();t.tag=e.tag;var r,a=n.getAccount(),i=(r=a.getContractsMap())?r.getEntryList().reduce(function(e,n){var t;return c({},e,((t={})[n[0]]=new TextDecoder("utf-8").decode(n[1]||new UInt8Array),t))},{}):{};return t.account={address:o.withPrefix(le(a.getAddress_asU8())),balance:a.getBalance(),code:new TextDecoder("utf-8").decode(a.getCode_asU8()||new UInt8Array),contracts:i,keys:a.getKeysList().map(function(e){return{index:e.getIndex(),publicKey:le(e.getPublicKey_asU8()),signAlgo:e.getSignAlgo(),hashAlgo:e.getHashAlgo(),weight:e.getWeight(),sequenceNumber:e.getSequenceNumber(),revoked:e.getRevoked()}})},t})})}catch(e){return Promise.reject(e)}}(e,t);case F(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){var o=(e=t).events.start?new r.GetEventsForHeightRangeRequest:new r.GetEventsForBlockIDsRequest;return o.setType(e.events.eventType),e.events.start?(o.setStartHeight(Number(e.events.start)),o.setEndHeight(Number(e.events.end))):e.events.blockIds.forEach(function(e){return o.addBlockIds(Buffer.from(e,"hex"))}),Promise.resolve(ie(n.node,r.AccessAPI.GetEventsForHeightRange,o)).then(function(n){var t=ae();t.tag=e.tag;var r=n.getResultsList();return t.events=r.reduce(function(e,n){var t=n.getBlockId(),r=n.getBlockHeight(),o=n.getBlockTimestamp();return n.getEventsList().forEach(function(n){var a;e.push({blockId:t,blockHeight:r,blockTimestamp:o,type:n.getType(),transactionId:(a=n.getTransactionId_asU8(),Buffer.from(a).toString("hex")),transactionIndex:n.getTransactionIndex(),eventIndex:n.getEventIndex(),payload:JSON.parse(Buffer.from(n.getPayload_asU8()).toString("utf8"))})}),e},[]),t})})}catch(e){return Promise.reject(e)}}(e,t);case J(e):case V(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var o=new r.GetLatestBlockRequest;return e.latestBlock&&e.latestBlock.isSealed&&(o.setIsSealed(e.latestBlock.isSealed),console.error("\n          %c@onflow/send Deprecation Notice\n          ========================\n\n          Operating upon data of the latestBlock field of the interaction object is deprecated and will no longer be recognized in future releases of @onflow/send.\n          Find out more here: https://github.com/onflow/flow-js-sdk/blob/master/packages/send/WARNINGS.md#0001-Deprecating-latestBlock-field\n\n          =======================\n        ".replace(/\n\s+/g,"\n").trim(),"font-weight:bold;font-family:monospace;")),e.block&&e.block.isSealed&&o.setIsSealed(e.block.isSealed),Promise.resolve(ie(n.node,r.AccessAPI.GetLatestBlock,o)).then(function(n){var t=n.getBlock(),r=t.getCollectionGuaranteesList(),o=t.getBlockSealsList(),a=t.getSignaturesList(),i=ae();return i.tag=e.tag,i.block={id:fe(t.getId_asU8()),parentId:fe(t.getParentId_asU8()),height:t.getHeight(),timestamp:t.getTimestamp(),collectionGuarantees:r.map(function(e){return{collectionId:fe(e.getCollectionId_asU8()),signatures:e.getSignaturesList()}}),blockSeals:o.map(function(e){return{blockId:fe(e.getBlockId_asU8()),executionReceiptId:fe(e.getExecutionReceiptId_asU8()),executionReceiptSignatures:e.getExecutionReceiptSignaturesList(),resultApprovalSignatures:e.getResultApprovalSignaturesList()}}),signatures:a},i})})}catch(e){return Promise.reject(e)}}(e,t);case W(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var o=new r.GetBlockByIDRequest;return o.setId(Buffer.from(e.block.id,"hex")),Promise.resolve(ie(n.node,r.AccessAPI.GetBlockByID,o)).then(function(n){var t=n.getBlock(),r=t.getCollectionGuaranteesList(),o=t.getBlockSealsList(),a=t.getSignaturesList(),i=ae();return i.tag=e.tag,i.block={id:de(t.getId_asU8()),parentId:de(t.getParentId_asU8()),height:t.getHeight(),timestamp:t.getTimestamp(),collectionGuarantees:r.map(function(e){return{collectionId:de(e.getCollectionId_asU8()),signatures:e.getSignaturesList()}}),blockSeals:o.map(function(e){return{blockId:de(e.getBlockId_asU8()),executionReceiptId:de(e.getExecutionReceiptId_asU8()),executionReceiptSignatures:e.getExecutionReceiptSignaturesList(),resultApprovalSignatures:e.getResultApprovalSignaturesList()}}),signatures:a},i})})}catch(e){return Promise.reject(e)}}(e,t);case M(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var o=new r.GetBlockByHeightRequest;return o.setHeight(Number(e.block.height)),Promise.resolve(ie(n.node,r.AccessAPI.GetBlockByHeight,o)).then(function(n){var t=n.getBlock(),r=t.getCollectionGuaranteesList(),o=t.getBlockSealsList(),a=t.getSignaturesList(),i=ae();return i.tag=e.tag,i.block={id:me(t.getId_asU8()),parentId:me(t.getParentId_asU8()),height:t.getHeight(),timestamp:t.getTimestamp(),collectionGuarantees:r.map(function(e){return{collectionId:me(e.getCollectionId_asU8()),signatures:e.getSignaturesList()}}),blockSeals:o.map(function(e){return{blockId:me(e.getBlockId_asU8()),executionReceiptId:me(e.getExecutionReceiptId_asU8()),executionReceiptSignatures:e.getExecutionReceiptSignaturesList(),resultApprovalSignatures:e.getResultApprovalSignaturesList()}}),signatures:a},i})})}catch(e){return Promise.reject(e)}}(e,t);case Y(e):return function(e,n){void 0===n&&(n={});try{return Promise.resolve(e).then(function(t){e=t;var o=new r.PingRequest;return Promise.resolve(ie(n.node,r.AccessAPI.Ping,o)).then(function(n){var t=ae();return t.tag=e.tag,t})})}catch(e){return Promise.reject(e)}}(e,t);default:return e}})},i=t.node;return Promise.resolve(i?a(i):Promise.resolve(n.config().get("accessNode.api")).then(a))}catch(e){return Promise.reject(e)}};function pe(e){return void 0===e&&(e=null),Z([R,function(n){return n.block.isSealed=e,k(n)}])}function he(e){return Z([N,function(n){return n.account.addr=o.sansPrefix(e),k(n)}])}var ve=function(e,n,t){try{try{return Promise.resolve(Number(e))}catch(e){throw new Error("Decode Number Error : "+t.join("."))}}catch(e){return Promise.reject(e)}},ye=function(e){return Promise.resolve(e)},ke=function(e,n,t){try{return Promise.resolve(e.fields.reduce(function(e,r){try{return Promise.resolve(e).then(function(o){return e=o,Promise.resolve(Pe(r.value,n,[].concat(t,[r.name]))).then(function(n){return e[r.name]=n,e})})}catch(e){return Promise.reject(e)}},Promise.resolve({}))).then(function(t){var r=e.id&&Ie(n,e.id);return r?Promise.resolve(r(t)):t})}catch(e){return Promise.reject(e)}},be={UInt:ve,Int:ve,UInt8:ve,Int8:ve,UInt16:ve,Int16:ve,UInt32:ve,Int32:ve,UInt64:ve,Int64:ve,UInt128:ve,Int128:ve,UInt256:ve,Int256:ve,Word8:ve,Word16:ve,Word32:ve,Word64:ve,UFix64:ye,Fix64:ye,String:ye,Character:ye,Bool:ye,Address:ye,Void:function(){return Promise.resolve(null)},Optional:function(e,n,t){return Promise.resolve(e?Pe(e,n,t):null)},Reference:function(e){try{return Promise.resolve({address:e.address,type:e.type})}catch(e){return Promise.reject(e)}},Array:function(e,n,t){try{return Promise.resolve(Promise.all(e.map(function(e){return new Promise(function(r){try{return Promise.resolve(Pe(e,n,[].concat(t,[e.type]))).then(r)}catch(e){return Promise.reject(e)}})})))}catch(e){return Promise.reject(e)}},Dictionary:function(e,n,t){try{return Promise.resolve(e.reduce(function(e,r){try{return Promise.resolve(e).then(function(o){return e=o,Promise.resolve(Pe(r.key,n,[].concat(t,[r.key]))).then(function(o){return Promise.resolve(Pe(r.value,n,[].concat(t,[r.key]))).then(function(n){return e[o]=n,e})})})}catch(e){return Promise.reject(e)}},Promise.resolve({})))}catch(e){return Promise.reject(e)}},Event:ke,Resource:ke,Struct:ke},Ie=function(e,n){var t=Object.keys(e).find(function(e){return/^\/.*\/$/.test(e)?new RegExp(e.substring(1,e.length-1)).test(n):e===n});return n&&t&&e[t]},Pe=function(e,n,t){try{var r=Ie(n,e.type);if(!r)throw new Error("Undefined Decoder Error: "+e.type+"@"+t.join("."));return Promise.resolve(r(e.value,n,t))}catch(e){return Promise.reject(e)}},Se=function(e,n,t){void 0===n&&(n={}),void 0===t&&(t=[]);var r=c({},be,n);return Promise.resolve(Pe(e,r,t))},we=function(e,n){void 0===n&&(n={});try{var t,r=c({},be,n),o=e.encodedData?(t=1,Promise.resolve(Se(e.encodedData,r))):e.transaction?(t=1,Promise.resolve(Promise.all(e.transaction.events.map(function(e){try{var n=e.eventIndex,t=e.transactionIndex,o=e.transactionId,a=e.type;return Promise.resolve(Se(e.payload,r)).then(function(e){return{type:a,transactionId:o,transactionIndex:t,eventIndex:n,data:e}})}catch(e){return Promise.reject(e)}}))).then(function(n){return c({},e.transaction,{events:n})})):e.events?(t=1,Promise.resolve(Promise.all(e.events.map(function(e){try{var n=e.eventIndex,t=e.transactionIndex,o=e.transactionId,a=e.type;return Promise.resolve(Se(e.payload,r)).then(function(e){return{type:a,transactionId:o,transactionIndex:t,eventIndex:n,data:e}})}catch(e){return Promise.reject(e)}})))):e.account?(t=1,e.account):e.block?(t=1,e.block):e.blockHeader?(t=1,e.blockHeader):e.latestBlock?(console.error("\n          %c@onflow/decode Deprecation Notice\n          ========================\n\n          Operating upon data of the latestBlock field of the response object is deprecated and will no longer be recognized in future releases of @onflow/decode.\n          Find out more here: https://github.com/onflow/flow-js-sdk/blob/master/packages/decode/WARNINGS.md#0001-Deprecating-latestBlock-field\n\n          =======================\n        ".replace(/\n\s+/g,"\n").trim(),"font-weight:bold;font-family:monospace;"),t=1,e.latestBlock):e.transactionId?(t=1,e.transactionId):void 0;return Promise.resolve(o&&o.then?o.then(function(e){return t?e:null}):t?o:null)}catch(e){return Promise.reject(e)}},Ae=function(e){try{var r=function(){if(K(e)||D(e)){var r=function(){return t.invariant(Te(o),"Cadence needs to be a string at this point."),Promise.resolve(n.config().where(/^0x/).then(function(e){return Object.entries(e).reduce(function(e,n){return e.replace(n[0],n[1])},o)})).then(function(n){e.message.cadence=n})},o=ne(e,"ix.cadence");t.invariant(Be(o)||Te(o),"Cadence needs to be a function or a string.");var a=function(){if(Be(o))return Promise.resolve(o({})).then(function(e){o=e})}();return a&&a.then?a.then(r):r()}}();return Promise.resolve(r&&r.then?r.then(function(){return e}):e)}catch(e){return Promise.reject(e)}},Be=function(e){return"function"==typeof e},Te=function(e){return"string"==typeof e},xe=function(e){try{if(K(e)||D(e))for(var n=0,r=Object.entries(e.arguments);n<r.length;n++){var o=r[n];e.arguments[o[0]].asArgument=(t.invariant(null!=typeof(a=o[1]).xform,"No type specified for argument: "+a.value),Ne(a.xform)?a.xform(a.value):Ne(a.xform.asArgument)?a.xform.asArgument(a.value):void t.invariant(!1,"Invalid Argument",a))}return Promise.resolve(e)}catch(e){return Promise.reject(e)}var a},Ne=function(e){return"function"==typeof e},Ee="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function je(e,n,t){if(!e.s){if(t instanceof Oe){if(!t.s)return void(t.o=je.bind(null,e,n));1&n&&(n=t.s),t=t.v}if(t&&t.then)return void t.then(je.bind(null,e,n),je.bind(null,e,2));e.s=n,e.v=t;var r=e.o;r&&r(e)}}var Oe=function(){function e(){}return e.prototype.then=function(n,t){var r=new e,o=this.s;if(o){var a=1&o?n:t;if(a){try{je(r,1,a(this.v))}catch(e){je(r,2,e)}return r}return this}return this.o=function(e){try{var o=e.v;1&e.s?je(r,1,n?n(o):o):t?je(r,1,t(o)):je(r,2,o)}catch(e){je(r,2,e)}},r},e}();function Le(e){return e instanceof Oe&&1&e.s}var _e=function(e){try{var n=function(){if(K(e))return function(n,t){try{var r=Promise.resolve(Re(e,Object.values(e.accounts))).then(function(){return Promise.resolve(Re(e,Object.values(e.accounts))).then(function(){})})}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}(0,function(e){throw console.error("=== SAD PANDA ===\n\n",e,"\n\n=== SAD PANDA ==="),e})}();return Promise.resolve(n&&n.then?n.then(function(n){return e}):e)}catch(e){return Promise.reject(e)}},Re=function e(n,r,o,a){void 0===a&&(a=3);try{var i=function(){o&&(n.authorizations=n.authorizations.map(function(e){return e===o.tempId?s:e}).reduce(function(e,n){return Array.isArray(n)?[].concat(e,n):[].concat(e,[n])},[]))};t.invariant(a,"Account Resolve Recursion Limit Exceeded",{ix:n,accounts:r});var s=[],u=function(e,n,t){if("function"==typeof e[Ee]){var r,o,a,i=e[Ee]();if(function e(t){try{for(;!(r=i.next()).done;)if((t=n(r.value))&&t.then){if(!Le(t))return void t.then(e,a||(a=je.bind(null,o=new Oe,2)));t=t.v}o?je(o,1,t):o=t}catch(e){je(o||(o=new Oe),2,e)}}(),i.return){var s=function(e){try{r.done||i.return()}catch(e){}return e};if(o&&o.then)return o.then(s,function(e){throw s(e)});s()}return o}if(!("length"in e))throw new TypeError("Object is not iterable");for(var u=[],c=0;c<e.length;c++)u.push(e[c]);return function(e,n,t){var r,o,a=-1;return function t(i){try{for(;++a<e.length;)if((i=n(a))&&i.then){if(!Le(i))return void i.then(t,o||(o=je.bind(null,r=new Oe,2)));i=i.v}r?je(r,1,i):r=i}catch(e){je(r||(r=new Oe),2,e)}}(),r}(u,function(e){return n(u[e])})}(r,function(t){function r(){function r(){i.tempId!=t.tempId&&delete n.accounts[i.tempId]}var u=function(){if(Array.isArray(t))return Promise.resolve(e(n,t,i,a-1)).then(function(){});n.accounts[t.tempId]=n.accounts[t.tempId]||t,n.accounts[t.tempId].role.proposer=n.accounts[t.tempId].role.proposer||t.role.proposer,n.accounts[t.tempId].role.payer=n.accounts[t.tempId].role.payer||t.role.payer,n.accounts[t.tempId].role.authorizer=n.accounts[t.tempId].role.authorizer||t.role.authorizer,n.accounts[t.tempId].role.proposer&&n.proposer===i.tempId&&(n.proposer=t.tempId),n.accounts[t.tempId].role.payer&&n.payer===i.tempId&&(n.payer=t.tempId),n.accounts[t.tempId].role.authorizer&&(o?s=[].concat(s,[t.tempId]):n.authorizations=n.authorizations.map(function(e){return e===i.tempId?t.tempId:e}))}();return u&&u.then?u.then(r):r()}var i=o||t,u=function(){if(Ge(t.resolve))return Promise.resolve(t.resolve(t,function(e,n){try{return{f_type:"PreSignable",f_vsn:"1.0.0",roles:e.role,cadence:n.message.cadence,args:n.message.arguments.map(function(e){return n.arguments[e].asArgument}),data:{},interaction:n}}catch(e){throw console.error("buildPreSignable",e),e}}(t,n))).then(function(e){t=e})}();return u&&u.then?u.then(r):r()});return Promise.resolve(u&&u.then?u.then(i):i())}catch(e){return Promise.reject(e)}},Ge=function(e){return"function"==typeof e},Ue=function(e,n){return Buffer.from(e.padStart(2*n,0),"hex")},Ce=function(e){return Ue(e,8)},De=function(e){return Buffer.from(JSON.stringify(e),"utf8")},Ke=function(e){return s.encode(e).toString("hex")},qe=function(e){return Fe(e),[(n=e.script,Buffer.from(n,"utf8")),e.arguments.map(De),(t=e.refBlock,Ue(t,32)),e.gasLimit,Ce(e.proposalKey.address),e.proposalKey.keyId,e.proposalKey.sequenceNum,Ce(e.payer),e.authorizers.map(Ce)];var n,t},He=function(e){var n=ze(e);return e.payloadSigs.map(function(e){return{signerIndex:n.get(e.address),keyId:e.keyId,sig:e.sig}}).sort(function(e,n){return e.signerIndex>n.signerIndex?1:e.signerIndex<n.signerIndex?-1:e.keyId>n.keyId?1:e.keyId<n.keyId?-1:void 0}).map(function(e){return[e.signerIndex,e.keyId,(n=e.sig,Buffer.from(n,"hex"))];var n})},ze=function(e){var n=new Map,t=0,r=function(e){n.has(e)||(n.set(e,t),t++)};return r(e.proposalKey.address),r(e.payer),e.authorizers.forEach(r),n},Fe=function(e){Ve.forEach(function(n){return Ze(e,n)}),$e.forEach(function(n){return Ze(e.proposalKey,n,"proposalKey")})},Je=function(e){return"number"==typeof e},We=function(e){return"string"==typeof e},Me=function(e){return null!==e&&"object"==typeof e},Ye=function(e){return Me(e)&&e instanceof Array},Ve=[{name:"script",check:We},{name:"arguments",check:Ye},{name:"refBlock",check:We,defaultVal:"0"},{name:"gasLimit",check:Je},{name:"proposalKey",check:Me},{name:"payer",check:We},{name:"authorizers",check:Ye}],$e=[{name:"address",check:We},{name:"keyId",check:Je},{name:"sequenceNum",check:Je}],Xe=[{name:"payloadSigs",check:Ye}],Qe=[{name:"address",check:We},{name:"keyId",check:Je},{name:"sig",check:We}],Ze=function(e,n,t,r){var o=n.name,a=n.check,i=n.defaultVal;if(null==e[o]&&null!=i&&(e[o]=i),null==e[o])throw nn(o,t,r);if(!a(e[o]))throw tn(o,t,r)},en=function(e,n,t){return n?null==t?n+"."+e:n+"."+t+"."+e:e},nn=function(e,n,t){return new Error("Missing field "+en(e,n,t))},tn=function(e,n,t){return new Error("Invalid field "+en(e,n,t))},rn=function(e){try{var n=function(){if(K(e))return function(n,t){try{var r=(a=function(e){var n=new Set(e.authorizations);return n.add(e.proposer),n.delete(e.payer),Array.from(n)}(e),o=an(e),i=Ke(qe(o)),Promise.resolve(Promise.all(a.map(on(e,i)))).then(function(){var n=function(e){var n=new Set([e.payer]);return Array.from(n)}(e),t=function(e){return Ke(function(e){return function(e){Xe.forEach(function(n){return Ze(e,n)}),e.payloadSigs.forEach(function(e,n){Qe.forEach(function(t){return Ze(e,t,"payloadSigs",n)})})}(e),[qe(e),He(e)]}(e))}(c({},an(e),{payloadSigs:a.map(function(n){return{address:e.accounts[n].addr,keyId:e.accounts[n].keyId,sig:e.accounts[n].signature}})}));return Promise.resolve(Promise.all(n.map(on(e,t)))).then(function(){})}))}catch(e){return t(e)}var o,a,i;return r&&r.then?r.then(void 0,t):r}(0,function(n){throw console.error("Signatures",n,{ix:e}),n})}();return Promise.resolve(n&&n.then?n.then(function(n){return e}):e)}catch(e){return Promise.reject(e)}};function on(e,n){return function(t){try{var r=e.accounts[t];return null!=r.signature?Promise.resolve():Promise.resolve(r.signingFunction(function(e,n,t){try{return{f_type:"Signable",f_vsn:"1.0.0",message:n,addr:o.sansPrefix(e.addr),keyId:e.keyId,roles:e.role,cadence:t.message.cadence,args:t.message.arguments.map(function(e){return t.arguments[e].asArgument}),data:{},interaction:t}}catch(e){throw console.error("buildSignable",e),e}}(r,n,e))).then(function(n){e.accounts[t].signature=n.signature})}catch(e){return Promise.reject(e)}}}function an(e){return{script:e.message.cadence,refBlock:e.message.refBlock||null,gasLimit:e.message.computeLimit,arguments:e.message.arguments.map(function(n){return e.arguments[n].asArgument}),proposalKey:{address:o.sansPrefix(e.accounts[e.proposer].addr),keyId:e.accounts[e.proposer].keyId,sequenceNum:e.accounts[e.proposer].sequenceNum},payer:o.sansPrefix(e.accounts[e.payer].addr),authorizers:e.authorizations.map(function(n){return o.sansPrefix(e.accounts[n].addr)}).reduce(function(e,n){return e.find(function(e){return e===n})?e:[].concat(e,[n])},[])}}var sn=function(e){try{var n=ne(e,"ix.validators",[]);return Promise.resolve(Z(e,n.map(function(e){return function(n){return e(n,{Ok:k,Bad:b})}})))}catch(e){return Promise.reject(e)}},un=Z([Ae,xe,_e,function(e){try{var n=function(){if(K(e)&&null==e.message.refBlock)return Promise.resolve(ge([pe()],opts).then(we)).then(function(n){e.message.refBlock=n.id})}();return Promise.resolve(n&&n.then?n.then(function(){return e}):e)}catch(e){return Promise.reject(e)}},function(e){try{var n=function(){if(K(e)){var n=Object.values(e.accounts).find(function(e){return e.role.proposer});t.invariant(n,"Transactions require a proposer");var r=function(){if(null==n.sequenceNum)return Promise.resolve(oe([he(n.addr)])).then(function(t){return Promise.resolve(ge(t).then(we).then(function(e){return e.keys}).then(function(e){return e.find(function(e){return e.index===n.keyId})}).then(function(e){return e.sequenceNumber})).then(function(t){e.accounts[n.tempId].sequenceNum=t})})}();if(r&&r.then)return r.then(function(){})}}();return Promise.resolve(n&&n.then?n.then(function(){return e}):e)}catch(e){return Promise.reject(e)}},rn,function(e){try{for(var n=0,t=Object.keys(e.accounts);n<t.length;n++){var r=t[n];e.accounts[r].addr=o.sansPrefix(e.accounts[r].addr)}return Promise.resolve(e)}catch(e){return Promise.reject(e)}},sn]),cn=function(e,t){void 0===e&&(e=[]),void 0===t&&(t={});try{return Promise.resolve(n.config().get("sdk.send",t.send||ge)).then(function(r){return Promise.resolve(n.config().get("sdk.resolve",t.resolve||un)).then(function(n){return Array.isArray(e)&&(e=Z(m(),e)),Promise.resolve(n(e)).then(function(e){return r(e,t)})})})}catch(e){return Promise.reject(e)}},ln={authorizer:!0};function fn(e){return re("ix.validators",function(n){return Array.isArray(n)?n.push(e):[e]})}var dn={proposer:!0},mn={payer:!0},gn=[];Object.defineProperty(e,"cadence",{enumerable:!0,get:function(){return u.template}}),Object.defineProperty(e,"cdc",{enumerable:!0,get:function(){return u.template}}),e.account=function(e,n){return cn([he(e)],n).then(we)},e.arg=function(e,n){return{value:e,xform:n}},e.args=function(e){return void 0===e&&(e=[]),Z(e.map(w))},e.atBlockHeight=function(e){return Z([function(n){return n.block.height=e,k(n)},fn(function(e,n){var t=n.Ok,r=n.Bad;return"boolean"==typeof e.block.isSealed?r(e,"Unable to specify both block height and isSealed."):e.block.id?r(e,"Unable to specify both block height and block id."):t(e)})])},e.atBlockId=function(e){return Z([function(n){return n.block.id=e,k(n)},fn(function(e,n){var t=n.Ok,r=n.Bad;return z(e)?r(e,"Unable to specify a block id with a Get Account interaction."):"boolean"==typeof e.block.isSealed?r(e,"Unable to specify both block id and isSealed."):e.block.height?r(e,"Unable to specify both block id and block height."):t(e)})])},e.authorization=function(e,n,t,r){return{addr:e,signingFunction:n,keyId:t,sequenceNum:r}},e.authorizations=function(e){return void 0===e&&(e=[]),Z(e.map(function(e){return n="function"==typeof e?{resolve:e,role:ln,roles:ln}:c({},e,{role:ln,roles:ln}),function(e){var t=y();return e.authorizations.push(t),k(Z(e,[P(n,t)]))};var n}))},e.build=oe,e.decode=function(e){try{return Promise.resolve(n.config().where(/^decoder\./)).then(function(n){var t=Object.entries(n).map(function(e){var n=e[0],t=e[1];return[n="/"+n.replace(/^decoder\./,"")+"$/",t]});return we(e,Object.fromEntries(t))})}catch(e){return Promise.reject(e)}},e.destroy=function(e){return function(n){return delete n.assigns[e],k(n)}},e.get=ne,e.getAccount=he,e.getBlock=pe,e.getBlockByHeight=function(e){return console.warn("\n    %cFCL/SDK Deprecation Notice\n    ============================\n\n    The getBlockByHeight builder has been deprecated and will be removed in future versions of the Flow JS-SDK/FCL.\n    You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0003-deprecate-get-block-by-height-builder\n\n    ============================\n  ","font-weight:bold;font-family:monospace;"),Z([L,function(n){return n.block.height=e,k(n)}])},e.getBlockById=function(e){return console.warn("\n    %cFCL/SDK Deprecation Notice\n    ============================\n\n    The getBlockById builder has been deprecated and will be removed in future versions of the Flow JS-SDK/FCL.\n    You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0004-deprecate-get-block-by-id-builder\n\n    ============================\n  ","font-weight:bold;font-family:monospace;"),Z([O,function(n){return n.block.ids=[e],k(n)}])},e.getBlockHeader=function(e){return void 0===e&&(e=null),Z([G,function(n){return n.block.isSealed=e,k(n)}])},e.getEvents=function(e,n,t){return void 0===n&&void 0===t||console.warn("\n      %cFCL/SDK Deprecation Notice\n      ============================\n  \n      Passing a start and end into getEnvents has been deprecated and will not be supported in future versions of the Flow JS-SDK/FCL.\n      You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0005-deprecate-start-end-get-events-builder\n  \n      ============================\n    ","font-weight:bold;font-family:monospace;"),Z([E,function(r){return r.events.eventType=e,r.events.start=n,r.events.end=t,k(r)}])},e.getEventsAtBlockHeightRange=function(e,n,t){return Z([E,function(r){return r.events.eventType=e,r.events.start=n,r.events.end=t,k(r)}])},e.getEventsAtBlockIds=function(e){return void 0===e&&(e=[]),Z([E,function(n){return n.events.eventType=eventType,n.events.blockIds=e,k(n)}])},e.getLatestBlock=function(e){return void 0===e&&(e=!1),console.warn("\n    %cFCL/SDK Deprecation Notice\n    ============================\n\n    The getLatestBlock builder has been deprecated and will be removed in future versions of the Flow JS-SDK/FCL.\n    You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0006-deprecate-get-latest-block-builder\n\n    ============================\n  ","font-weight:bold;font-family:monospace;"),Z([j,function(n){return n.block.isSealed=e,k(n)}])},e.getTransaction=function(e){return Z([x,function(n){return n.transaction.id=e,k(n)}])},e.getTransactionStatus=function(e){return Z([T,function(n){return n.transaction.id=e,k(n)}])},e.interaction=m,e.invariant=function e(){var n=[].slice.call(arguments);if(n.length>1){var t=n,r=t[0],o=t[1];return e(function(e,n){var t=n.Bad;return r?(0,n.Ok)(e):t(e,o)})}var a=n[0];return function(e){return a(e,{Ok:k,Bad:b})}},e.isBad=X,e.isGetAccount=z,e.isGetBlock=V,e.isGetBlockByHeight=M,e.isGetBlockById=W,e.isGetBlockHeader=$,e.isGetEvents=F,e.isGetLatestBlock=J,e.isGetTransaction=H,e.isGetTransactionStatus=q,e.isOk=function(e){return"OK"===e.status},e.isPing=Y,e.isScript=D,e.isTransaction=K,e.isUnknown=C,e.latestBlock=function(){var e=[].slice.call(arguments),n=e[1]||("object"==typeof e[0]?e[0]:void 0),t="boolean"==typeof e[0]?e[0]:void 0;return"object"!=typeof e[0]&&console.warn("\n      %cFCL/SDK Deprecation Notice\n      ============================\n  \n      Passing options as the first arguement to the latestBlock function has been deprecated and will be removed in future versions of the Flow JS-SDK/FCL.\n      You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0007-deprecate-opts-first-arg-latest-block\n  \n      ============================\n    ","font-weight:bold;font-family:monospace;"),cn([pe(t)],n).then(we)},e.limit=function(e){return Z([function(n){return n.message.computeLimit=e,k(n)}])},e.param=function(e,n,t){return void 0===t&&(t=null),{key:t,value:e,xform:null}},e.params=function(e){return void 0===e&&(e=[]),Z(e.map(S))},e.payer=function(e){return n="function"==typeof e?{resolve:e,role:mn,roles:mn}:c({},e,{role:mn,roles:mn}),function(e){var t=y();return e.payer=t,k(Z(e,[P(n,t)]))};var n},e.ping=function(){return _},e.pipe=Z,e.proposer=function(e){try{return Promise.resolve((n="function"==typeof e?{resolve:e,role:dn,roles:dn}:c({},e,{role:dn,roles:dn}),function(e){var t=y();return e.proposer=t,k(Z(e,[P(n,t)]))}))}catch(e){return Promise.reject(e)}var n},e.put=te,e.ref=function(e){return Z([function(n){return n.message.refBlock=e,k(n)}])},e.resolve=un,e.resolveAccounts=_e,e.resolveArguments=xe,e.resolveParams=function(e){return console.error("\n      %cFCL/SDK Deprecation Notice\n      ============================\n\n      The resolver sdk.resolveParams is being replaced with the package @onflow/sdk-resolve-cadence\n      You can learn more (including a guide on common transition paths) here: https://github.com/onflow/flow-js-sdk/blob/master/packages/sdk/TRANSITIONS.md#0002-deprecate-resolve-params-resolver\n\n      ============================\n    ","font-weight:bold;font-family:monospace;"),Ae(e)},e.resolveRefBlockId=function(e){return function(n){try{return K(n)?n.message.refBlock?Promise.resolve(k(n)):Promise.resolve(function(e){try{var n;return Promise.resolve(Z(m(),[pe()])).then(function(t){return n=t,Promise.resolve(ge(n,e)).then(function(e){return n=e,Promise.resolve(we(n)).then(function(e){return(n=e).id})})})}catch(e){return Promise.reject(e)}}(e)).then(function(e){return n.message.refBlock=e,k(n)}):Promise.resolve(k(n))}catch(e){return Promise.reject(e)}}},e.resolveSignatures=rn,e.resolveValidators=sn,e.script=function(){return Z([A,te("ix.cadence",u.template.apply(void 0,[].slice.call(arguments)))])},e.send=cn,e.transaction=function(){return Z([B,te("ix.cadence",u.template.apply(void 0,[].slice.call(arguments))),function(e){return e.message.computeLimit=e.message.computeLimit||10,e.message.refBlock=e.message.refBlock||null,e.authorizations=e.authorizations||gn,k(e)}])},e.update=re,e.validator=fn,e.why=function(e){return e.reason}});
//# sourceMappingURL=sdk.umd.js.map
